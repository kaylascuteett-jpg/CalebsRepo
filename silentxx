-- === FPS BOOST SETTINGS ===
local RunService = game:GetService("RunService")
local Lighting = game:GetService("Lighting")
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local Workspace = game:GetService("Workspace")

-- Aggressive graphics/Lag saver
pcall(function()
    for _, part in pairs(Workspace:GetDescendants()) do
        if part:IsA("Texture") or part:IsA("Decal") then
            part.Transparency = 1
        elseif part:IsA("MeshPart") or part:IsA("Part") then
            part.Material = Enum.Material.SmoothPlastic
            part.Reflectance = 0
        end
    end
end)

-- Lower physics update overhead
Workspace:WaitForChild("Terrain").WaterWaveSize = 0
Workspace:WaitForChild("Terrain").WaterWaveSpeed = 0

-- Reduce lighting effects for FPS
--Lighting.Brightness = 1
--Lighting.ClockTime = 12

-- Load the aiming module
local Aiming = loadstring(game:HttpGet("https://raw.githubusercontent.com/RFS-cmd/-/main/model"))()

-- Optimized settings (reduces lag significantly)
Aiming.TargetPart = {"UpperTorso"}          -- Only head = faster
Aiming.FOV = 40                       -- Slightly larger for easier targeting
Aiming.FOVSides = 60                   -- Lower = less overhead, still smooth
Aiming.HitChance = 123432210000034873243247347324327123               -- 100+ = always hit, skips random calc
Aiming.ShowFOV = true
Aiming.VisibleCheck = false            -- Disable wall check (big FPS saver)

Aiming.TeamCheck(false)                -- No team check

getgenv().Prediction = 0.000001    -- Your preferred prediction value

-- Services
local Players = game:GetService("Players")
local Workspace = game:GetService("Workspace")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local LocalPlayer = Players.LocalPlayer
local CurrentCamera = Workspace.CurrentCamera

-- DaHoodSettings
local DaHoodSettings = {
    SilentAim = true,
    AimLock = false,
    Prediction = getgenv().Prediction,
    AimLockKeybind = Enum.KeyCode.E
}
getgenv().DaHoodSettings = DaHoodSettings
getgenv().SilentAimEnabled = true     -- Controlled by GUI

-- Improved KO/Grabbed check (no WaitForChild)
function Aiming.Check()
    if not (Aiming.Enabled == true and Aiming.Selected ~= LocalPlayer and Aiming.SelectedPart ~= nil) then
        return false
    end
    if not getgenv().SilentAimEnabled then
        return false
    end

    local Character = Aiming.Character(Aiming.Selected)
    if not Character then return false end

    local BodyEffects = Character:FindFirstChild("BodyEffects")
    local KOd = BodyEffects and BodyEffects:FindFirstChild("K.O") and BodyEffects["K.O"].Value
    local Grabbed = Character:FindFirstChild("GRABBING_CONSTRAINT") ~= nil

    if KOd or Grabbed then
        return false
    end

    return true
end

-- Hook for silent aim
local __index
__index = hookmetamethod(game, "__index", function(t, k)
    if t:IsA("Mouse") and (k == "Hit" or k == "Target") and Aiming.Check() then
        local SelectedPart = Aiming.SelectedPart
        if DaHoodSettings.SilentAim then
            local Hit = SelectedPart.CFrame + (SelectedPart.Velocity * DaHoodSettings.Prediction)
            return (k == "Hit" and Hit or SelectedPart)
        end
    end
    return __index(t, k)
end)

-- Aimlock (optional)
RunService:BindToRenderStep("AimLock", 0, function()
    if DaHoodSettings.AimLock and Aiming.Check() and UserInputService:IsKeyDown(DaHoodSettings.AimLockKeybind) then
        local SelectedPart = Aiming.SelectedPart
        local Hit = SelectedPart.CFrame + (SelectedPart.Velocity * DaHoodSettings.Prediction)
        CurrentCamera.CFrame = CFrame.lookAt(CurrentCamera.CFrame.Position, Hit.Position)
    end
end)

-- ===== THROTTLED TARGET UPDATE (MAIN LAG FIX) =====
local lastTargetUpdate = 0
RunService.Heartbeat:Connect(function()
    Aiming.UpdateFOV()  -- Keep FOV circle smooth every frame

    local now = tick()
    if now - lastTargetUpdate >= 0.1 then  -- ~15 updates per second (adjust higher like 0.1 for even more FPS)
        Aiming.GetClosestPlayerToCursor()
        lastTargetUpdate = now
    end
end)

-- ===== GUI =====
local gui = Instance.new("ScreenGui")
gui.Name = "SilentAimUI"
gui.ResetOnSpawn = false
gui.Parent = LocalPlayer:WaitForChild("PlayerGui")

-- Toggle button (top-right)
local toggleButton = Instance.new("TextButton")
toggleButton.Size = UDim2.fromOffset(130, 32)
toggleButton.Position = UDim2.new(1, -140, 0, 10)
toggleButton.Text = "Silent Aim"
toggleButton.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
toggleButton.TextColor3 = Color3.fromRGB(255, 255, 255)
toggleButton.BorderSizePixel = 0
toggleButton.BackgroundTransparency = 0.5
toggleButton.Parent = gui

-- Main frame
local frame = Instance.new("Frame")
frame.Size = UDim2.fromOffset(260, 360)
frame.Position = UDim2.new(1, -280, 0, 50)
frame.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
frame.BorderSizePixel = 0
frame.Visible = false
frame.Parent = gui

local corner = Instance.new("UICorner", frame)
corner.CornerRadius = UDim.new(0, 8)

local layout = Instance.new("UIListLayout")
layout.Padding = UDim.new(0, 10)
layout.Parent = frame

local padding = Instance.new("UIPadding")
padding.PaddingTop = UDim.new(0, 10)
padding.PaddingLeft = UDim.new(0, 10)
padding.PaddingRight = UDim.new(0, 10)
padding.Parent = frame

-- Helpers
local function makeContainer(labelText)
    local container = Instance.new("Frame")
    container.Size = UDim2.fromOffset(240, 50)
    container.BackgroundTransparency = 1
    container.Parent = frame

    local label = Instance.new("TextLabel")
    label.Size = UDim2.fromOffset(240, 20)
    label.BackgroundTransparency = 1
    label.TextColor3 = Color3.fromRGB(255, 255, 255)
    label.TextXAlignment = Enum.TextXAlignment.Left
    label.Text = labelText
    label.Parent = container

    return container
end

local function makeBox(container, default, callback)
    local box = Instance.new("TextBox")
    box.Size = UDim2.fromOffset(240, 25)
    box.Position = UDim2.new(0, 0, 0, 25)
    box.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
    box.TextColor3 = Color3.fromRGB(255, 255, 255)
    box.BorderSizePixel = 0
    box.Text = tostring(default)
    box.ClearTextOnFocus = false
    box.Parent = container

    box.FocusLost:Connect(function()
        local v = tonumber(box.Text)
        if v then callback(v) end
    end)
end

local function makeToggle(container, default, callback)
    local toggle = Instance.new("TextButton")
    toggle.Size = UDim2.fromOffset(240, 25)
    toggle.Position = UDim2.new(0, 0, 0, 25)
    toggle.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
    toggle.TextColor3 = Color3.fromRGB(255, 255, 255)
    toggle.BorderSizePixel = 0
    toggle.Text = default and "ON" or "OFF"
    toggle.Parent = container

    local state = default
    toggle.MouseButton1Click:Connect(function()
        state = not state
        toggle.Text = state and "ON" or "OFF"
        callback(state)
    end)
end

-- GUI Controls
do
    local c = makeContainer("FOV Size")
    makeBox(c, Aiming.FOV, function(v) Aiming.FOV = v end)

    local c = makeContainer("Hit Chance")
    makeBox(c, Aiming.HitChance, function(v) Aiming.HitChance = v end)

    local c = makeContainer("Prediction")
    makeBox(c, getgenv().Prediction, function(v)
        getgenv().Prediction = v
        DaHoodSettings.Prediction = v
    end)

    local c = makeContainer("Show FOV")
    makeToggle(c, Aiming.ShowFOV, function(v) Aiming.ShowFOV = v end)

    local c = makeContainer("Silent Aim")
    makeToggle(c, true, function(v) getgenv().SilentAimEnabled = v end)

    local c = makeContainer("Wall Check")
    makeToggle(c, false, function(v) Aiming.VisibleCheck = v end)
end

-- Toggle menu visibility
toggleButton.MouseButton1Click:Connect(function()
    frame.Visible = not frame.Visible
end)
-- ===== AUTO PREDICTION LOOP (100% HIT GUARANTEE) =====
spawn(function()
    while true do
        wait(1)  -- Low CPU, updates fast enough
        if getgenv().AutoPrediction then
            local Stats = game:GetService("Stats")
            local pingStr = Stats.Network.ServerStatsItem["Data Ping"]:GetValueString()
            local ping = tonumber(string.split(pingStr, "(")[1])
            if ping then
                local pred
                if ping > 200 then pred = 0.187
                elseif ping > 180 then pred = 0.168
                elseif ping > 140 then pred = 0.160
                elseif ping > 110 then pred = 0.159
                elseif ping > 105 then pred = 0.138
                elseif ping > 90 then pred = 0.136
                elseif ping > 80 then pred = 0.134
                elseif ping > 70 then pred = 0.131
                elseif ping > 60 then pred = 0.123
                elseif ping > 50 then pred = 0.1225
                else pred = 0.126  -- Ultra low ping
                end
                getgenv().Prediction = pred
                DaHoodSettings.Prediction = pred  -- Syncs aim hook
            end
        end
    end
end)

